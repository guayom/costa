$(document).ready(function () {

  var header_height = $('#header').height();

  /* parallax header */
  function parallax() {
    var scrolled = $(window).scrollTop();
    $('#header .backstretch img').css('top', '' + -(scrolled * 0.6) + 'px');
    $('.heading').css('background-position', 'center ' + -(scrolled * 0.5) + 'px');
  }


  /* backstretch slider */
//  $('.header-slide').backstretch([
//    "<%#= asset_path('bg01.jpg') %>",
//    "<%#= asset_path('bg02.jpg') %>",
//    "<%#= asset_path('bg03.jpg') %>"
//  ], {
//    fade: 850,
//    duration: 8000
//  });


  /* navbar */
  $(window).scroll(function () {
    parallax();
    if ($(window).scrollTop() > header_height) {
      //$('.navbar').css('border-bottom-color', '#37bc9b');
    } else {
      //$('.navbar').css('border-bottom-color', '#fff');
    }
  });

  /* scrolltop */
  $('.scroltop').on('click', function (event) {
    var $anchor = $(this);
    $('html, body').stop().animate({
      scrollTop: $($anchor.attr('href')).offset().top
    }, 1500, 'easeInOutExpo');
    event.preventDefault();
  });


  /* masonry layout */
  var $container = $('.container-realestate');
  $container.imagesLoaded(function () {
    $container.masonry();
  });


  /* modal */
  $('.modal').on('shown.bs.modal', function () {
    var curModal = this;
    $('.modal').each(function () {
      if (this != curModal) {
        $(this).modal('hide');
      }
    });
  });

  /* map property */
//  $('a[href="#location"]').on('shown.bs.tab', function () {
//    $("#map-property").gmap3({
//      map: {
//        options: {
//          center: [-7.866315, 110.389574],
//          zoom: 13,
//          scrollwheel: false
//        }
//      },
//      marker: {
//        latLng: [-7.866315, 110.389574],
//        options: {
//          icon: new google.maps.MarkerImage(
//              "https://dl.dropboxusercontent.com/u/29545616/Preview/location.png",
//              new google.maps.Size(48, 48, "px", "px")
//          )
//        }
//      }
//    });
//  })

  $(".mensajes-especiales li").css('background', function () { //or for code's consistency, i'd use background-color instead
    return "#" + $(this).data('color')
  });

  //Slick
  $('.property-slider').slick({
    infinite: true,
    speed: 300,
    slidesToShow: 1,
    adaptiveHeight: true,
    lazyLoad: 'ondemand',
    arrows: true,
    prevArrow: "<a class='jcarousel-control-prev main' href='#'>‹</a>",
    nextArrow: "<a class='jcarousel-control-next main' href='#'>›</a>"
  });

  $('.jcarousel-control-next.main').jcarouselControl({
    carousel: $(".jcarousel"),
    target: '+=1'
  });

  $('.jcarousel-pagination')
    .on('click', function(e) {
      e.preventDefault();
    })
    .on('jcarouselpagination:createend', function() {
      $('.jcarousel-pagination-wrapper').jcarousel({
        wrap: 'circular'
      }).jcarouselSwipe().jcarouselAutoscroll({autostart: false});
      $('.jcarousel-control-prev.secondary').jcarouselControl({
        carousel: $(".jcarousel-pagination-wrapper"),
        target: '-=1'
      });
      $('.jcarousel-control-next.secondary').jcarouselControl({
        carousel: $(".jcarousel-pagination-wrapper"),
        target: '+=1'
      });
    })
    .jcarouselPagination({
      carousel: $('.main-jcarousel'),
      perPage: 1,
      item: function(page, items) {
        return '<li><a href="#' + page + '"><img src="'
          + $(items).children('img').attr('src').replace('/large/', '/thumb/')
            + '"></a></li>';
      }
    });
});
