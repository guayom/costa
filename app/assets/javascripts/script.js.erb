$(document).ready(function () {

  var header_height = $('#header').height();

  /* parallax header */
  function parallax() {
    var scrolled = $(window).scrollTop();
    $('#header .backstretch img').css('top', '' + -(scrolled * 0.6) + 'px');
    $('.heading').css('background-position', 'center ' + -(scrolled * 0.5) + 'px');
  }

  /* navbar */
  $(window).scroll(function () {
    parallax();
    if ($(window).scrollTop() > header_height) {
      //$('.navbar').css('border-bottom-color', '#37bc9b');
    } else {
      //$('.navbar').css('border-bottom-color', '#fff');
    }
  });

  /* scrolltop */
  $('.scroltop').on('click', function (event) {
    var $anchor = $(this);
    $('html, body').stop().animate({
      scrollTop: $($anchor.attr('href')).offset().top
    }, 1500, 'easeInOutExpo');
    event.preventDefault();
  });


  /* masonry layout */
  var $container = $('.container-realestate');
  $container.imagesLoaded(function () {
    $container.masonry();
  });


  /* modal */
  $('.modal').on('shown.bs.modal', function () {
    var curModal = this;
    $('.modal').each(function () {
      if (this != curModal) {
        $(this).modal('hide');
      }
    });
  });

  $(".mensajes-especiales li").css('background', function () { //or for code's consistency, i'd use background-color instead
    return "#" + $(this).data('color')
  });

  //Slick
  $('.property-slider').slick({
    infinite: true,
    speed: 500,
    slidesToShow: 1,
    adaptiveHeight: true,
    //lazyLoad: 'ondemand',
    arrows: true,
    prevArrow: "<a class='jcarousel-control-prev main' href='#'>‹</a>",
    nextArrow: "<a class='jcarousel-control-next main' href='#'>›</a>",
    mobileFirst: true,
    autoplay: true,
    autoplaySpeed: 6000,
  });

  $('.slider-nav').slick({
    slidesToShow: 3,
    slidesToScroll: 1,
    asNavFor: '.property-slider',
    centerMode: true,
    focusOnSelect: true,
    arrows: false,
    lazyLoad: 'progressive',
    adaptiveHeight: false,
    variableWidth: true,
    centerMode: true,
  });

  function popUp(e){
    e.preventDefault;
    var elem = document.createElement('div');
    var container = document.createElement('div');
    var closeBtn = document.createElement('div');
    elem.id = "slider-modal-container"
    elem.style.cssText = 'position:fixed;width:100%;height:100%;z-index:99999;background:rgba(0,0,0,0.8);top:0;left:0;';
    closeBtn.style.cssText = 'position:fixed;top: 20px; right: 20px; width: 20px; height: 20px;  text align: center; line-height: 20px; font-size: 20px; font-weight: bold; font-family: helvetica; color: #fff; cursor: pointer;';
    container.id = "slider-modal";
    container.style.cssText = 'max-width: 650px; height: 80vh; margin: 10vh auto;';
    document.body.appendChild(elem);
    elem.appendChild(container);
    elem.appendChild(closeBtn);
    closeBtn.append("x");
    closeBtn.id = "close-modal-button";
    $( ".property-slider" ).appendTo( container );
  }

  $('.property-slider .slick-slide').click(function(e){
    popUp(e);
  });
});

function closeModal(e){
  console.log(e);
  $( ".property-slider" ).appendTo('.big-picture');
  $('#slider-modal-container').remove();
}

$(document).on('click', '#close-modal-button', function(e){
  closeModal(e);
});
